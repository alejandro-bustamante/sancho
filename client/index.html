<!doctype html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Buscador de canciones</title>
  <script src="./search.js"></script>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <!-- Opciones de tema para Tailwind -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'dark': '#222831',
            'dark-gray': '#393e46',
            'orange': '#f96d00',
            'light': '#f2f2f2'
          }
        }
      }
    }
  </script>
</head>

<body class="bg-dark-gray text-light min-h-screen flex flex-col items-center pt-5">
  <div x-data="searchApp()" class="w-full px-4">
    <!-- Notification system -->
    <div class="fixed top-5 right-5 z-50 flex flex-col gap-3 w-80">
      <template x-for="notification in notifications" :key="notification.id">
        <div x-show="notification.show" x-transition:enter="transition ease-out duration-300"
          x-transition:enter-start="opacity-0 transform translate-x-full"
          x-transition:enter-end="opacity-100 transform translate-x-0"
          x-transition:leave="transition ease-in duration-200"
          x-transition:leave-start="opacity-100 transform translate-x-0"
          x-transition:leave-end="opacity-0 transform translate-x-full" :class="{
            'bg-green-500': notification.type === 'success',
            'bg-blue-500': notification.type === 'info',
            'bg-red-500': notification.type === 'error'
          }" class="rounded-lg shadow-lg p-4 text-white flex justify-between items-center">
          <span x-text="notification.message"></span>
          <button @click="hideNotification(notification.id)" class="ml-4 text-white hover:text-gray-200">
            &times;
          </button>
        </div>
      </template>
    </div>

    <div class="flex flex-wrap justify-center items-center gap-2 my-4">
      <div class="flex w-full max-w-xs flex-col gap-1 text-on-surface dark:text-on-surface-dark">
        <label for="textInputDefault" class="w-fit pl-0.5 text-sm">Name</label>
        <input x-model="trackQuery" @keyup.enter="searchTracks()" type="text"
          class="text-black w-full rounded-radius border border-outline bg-surface-alt px-2 py-2 text-sm focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary disabled:cursor-not-allowed disabled:opacity-75 dark:border-outline-dark dark:bg-surface-dark-alt/50 dark:focus-visible:outline-primary-dark"
          name="name" placeholder="Enter your name" autocomplete="name" />
      </div>
      <button @click="searchTracks()"
        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition-colors duration-300">
        Search
      </button>
      <select x-model="selectedUser" class="px-3 py-2 rounded border border-gray-300 text-gray-800">
        <option value="alejandro">Alejandro</option>
        <option value="alfredo">Alfredo</option>
      </select>
    </div>
    <div class="flex justify-center">
      <div x-show="isLoading" class="text-center py-4">
        <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div>
        <p class="mt-2">Cargando resultados...</p>
      </div>
    </div>
    <div x-show="!isLoading && tracks.length > 0"
      class="w-full max-w-3xl mx-auto bg-white rounded shadow-lg p-6 text-gray-800 overflow-y-auto max-h-[70vh]">
      <template x-for="track in tracks" :key="track.id">
        <div class="mb-6 pb-6 border-b border-gray-200">
          <h3 class="text-xl font-semibold text-blue-600 mb-2" x-text="track.title"></h3>
          <p class="text-sm text-gray-600">Link: <span x-text="track.link"></span></p>
          <p class="text-sm text-gray-600">Artist: <span x-text="track.artist.name"></span></p>
          <p class="text-sm text-gray-600">Album: <span x-text="track.album.title"></span></p>
          <div class="flex flex-wrap items-center mt-3">
            <img :src="track.album.cover_small" :alt="track.album.title" class="rounded mr-4">
            <audio controls class="mt-2 w-full">
              <source :src="track.preview" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio>
          </div>
          <button @click="downloadTrack(track)"
            class="mt-3 bg-orange hover:bg-orange/80 text-white px-3 py-2 rounded text-sm transition-colors duration-300">
            Download
          </button>
        </div>
      </template>
    </div>
  </div>
</body>

</html>